
export const VALUE_PROPOSITION_FRAMEWORK = `
# Value Proposition Framework (Alex Hormozi)

## 1. Dream Outcome (The Perfect Scenario)
*   "How would your operation look if you no longer depended on imports for critical components?"
*   "The vision: 100% auditable supply chain, local, with Swiss-German standards."
*   "From concept to patient: A flow without bottlenecks between R&D, machining, and sterilization."
*   "The engineer's dream: Launching new designs without hearing 'your supplier can't make this'."
*   "Unlock Cash Flow: Cut 20–30% of capital tied up in imported stock."

## 2. Perceived Likelihood of Achievement (Proof)
*   "Why ISO 13485 + ANVISA + CMM Zeiss make Lifetrek a safe bet, not an experiment."
*   "What we learned creating for FGM, GMI, Ultradent, and others – and how that reduces your risk."
*   "From part to report: How our dimensional reports reduce your receiving inspection workload."
*   "Technical Tour: Inside the Swiss lathes, CMM, and cleanrooms backing our quality."

## 3. Time Delay (Speed to Value)
*   "Importing in 90 days vs Local production in 30."
*   "Rapid Prototyping: Test new geometries without blocking registration schedules."
*   "Why being 1 flight away changes emergency response."
*   "Shorten the cycle from 'new drawing' to 'validated product'."

## 4. Effort & Sacrifice (Ease of Use)
*   "All in one place: Machining, finishing, metrology, cleanroom – no coordinating 4 vendors."
*   "Fewer crisis meetings, more engineering."
*   "Ready-made documentation (ISO 13485) simplifying internal/ANVISA audits."
*   "Stop 'babysitting' suppliers."
*   "On-demand supply model: Smaller, recurrent batches."
`;

export const COMPANY_CONTEXT = `
# Lifetrek Medical - Company Context & Brand Book
**Version**: 3.0 (Comprehensive / Brand Book)

## 1. Brand Identity & Voice
**Mission**: "To lead in the manufacture of high-performance products... with an absolute commitment to life."
**Tagline**: "Global Reach, Local Excellence."
**Tone**: Technical, Ethical, Confident, Partnership-Oriented.
**Key Themes**:
- **Risk Reduction**: "Manufacturing Capabilities That De-Risk Your Supply Chain".
- **Precision**: "Micron-level accuracy", "Zero-Defect Manufacturing".
- **Compliance**: "Regulatory Confidence", "ISO 13485:2016", "ANVISA".
- **Speed**: "Faster Time to Market".

## 2. Infrastructure & Machinery (Technical Specs)
Lifetrek operates a world-class facility in **Indaiatuba / SP, Brazil**.

### CNC Manufacturing (Swiss-Type & Turning)
*   **Citizen M32 (Swiss-Type CNC Lathe)**
    *   *Specs*: 32mm bar capacity, 12-axis control, live tooling.
    *   *Application*: Complex bone screws, intricate implants.
*   **Citizen L20 (Swiss-Type CNC Lathe)**
*   **Doosan Lynx 2100 (Turning Center)**
*   **Tornos GT26 (Multi-Axis)**
*   **FANUC Robodrill**
*   **Walter Helitronic** (Tool Grinding)

### Metrology & Quality Control
*   **ZEISS Contura (3D CMM)**: Accuracy 1.9 + L/300 μm, fully automated.
*   **Optical Comparator CNC**
*   **Olympus Microscope** (Metallographic analysis)
*   **Hardness Vickers** (Automated testing)

### Finishing & Facilities
*   **Electropolishing In-House**: Ra < 0.1μm mirror finish.
*   **Laser Marking**: Fiber laser for UDI.
*   **Cleanrooms**: Two ISO Class 7 cleanrooms.

## 3. Product Catalog
*   **Medical**: Spinal Systems, Trauma Fixation (Plates/Screws/Nails), Cranial, Extremities.
*   **Surgical Instruments**: Drills, Reamers, Taps, Guides, Handles.
*   **Dental**: Titanium Implants (Hex), Abutments, Tools.
*   **Veterinary**: Orthopedic Plates (TPLO), Bone Screws.

## 4. Client Portfolio
FGM Dental Group, Neortho, Ultradent Products, Traumec, Razek, Vincula, CPMH, Evolve, GMI, HCS, Impol, Implanfix, IOL, Plenum, Medens, OBL Dental, Orthometric, Óssea, React, Russer, TechImport, Toride.

## 5. Strategic Messaging
*   **OEMs**: "Eliminate supplier risks. ISO 13485 certified quality system."
*   **R&D**: "Accelerate product development. From ESD prototypes to mass production."
*   **Proof Points**: 30+ years experience, 100% Quality Board, In-House Finishing.
`;

export const KILLER_HOOKS_PLAYBOOK = `
# "Killer Hooks" Playbook (Acquisition.com Principles)

## DEFINITION
A Hook is a mini-sale of attention. It must have two parts:
1. **The Callout**: Makes the avatar think "That's me" (e.g., "Orthopedic OEMs").
2. **The Condition for Value**: Implies what they get (e.g., "Reduce recall risk").

## TYPES OF VERBAL HOOKS (MIX THESE)
1. **Labels**: "{Avatar}, {strong promise}" (e.g., "Dental Clinic Owners: Double your booking rate").
2. **Yes-Questions**: "Would you {huge benefit} in {short time}?"
3. **Open Questions**: "Which would you rather be: {A} or {B}?"
4. **Conditionals**: "If you're a {avatar} and you {do X}, you'll {get Y}."
5. **Strong Statements**: "The smartest thing you can do today as a {avatar}..."
6. **Command/Direct**: "Read this if you're tired of {pain}."
7. **Narratives**: "One day I was {situation} and then {unexpected result}..."
8. **Lists**: "{N} ways you're {wasting money} as a {avatar}."

## QUALITY CHECKLIST
*   Does it explicitly call out the audience?
*   Does it imply a clear benefit or avoided pain?
*   Is it under 15 words?
`;

export const LINKEDIN_BEST_PRACTICES = `
# LinkedIn Best Practices (Carousel Structure)

### Carousel Rules
*   **Slides**: 5-10 slides (7 is sweet spot).
*   **Dimensions**: 1080x1350px (Portrait).
*   **Text**: Minimal text (20-40 words max).
*   **Contrast**: High contrast, readable fonts.

### Slide Structure
*   **Slide 1 (Hook)**: MUST use a formula from the KILLER HOOKS PLAYBOOK.
*   **Slides 2-6 (Body)**: One key insight per slide.
*   **Slide 7 (CTA)**: Clear low-friction CTA.

### Caption Structure
1.  Hook (first 125 chars)
2.  Expand on promise
3.  Tease content
4.  CTA
5.  Hashtags
`;

export const BRAND_ASSOCIATIONS = `
# Brand Associations (Reinforce in EVERY carousel)

1. **"Local Swiss-level"** → Produção no Brasil com padrão tecnológico global
   - Mention: Citizen M32, Tornos GT26, ZEISS Contura
   - Proof: "Mesma precisão de fábricas suíças, a 1 voo de distância"

2. **"Regulatory-safe"** → ISO 13485, ANVISA, documentação para auditorias
   - Mention: Cleanroom ISO 7, rastreabilidade lote-a-lote
   - Proof: "30+ anos sem recall, 100% Quality Board"

3. **"Cash-friendly supply chain"** → Menos estoque, menos lead time
   - Mention: 30 dias vs 90 dias de importação
   - Proof: "Reduza 20-30% do capital parado em estoque"

4. **"Engineering partner"** → Co-engineering, DFM, suporte técnico
   - Mention: Prototipagem rápida, análise de manufaturabilidade
   - Proof: "Do desenho ao lote piloto em semanas, não meses"
`;

export function constructUserPrompt(
    topic: string,
    targetAudience: string,
    painPoint: string,
    desiredOutcome: string,
    proofPoints: string,
    ctaAction: string,
    isBatch: boolean,
    numberOfCarousels: number,
    postType: "value" | "commercial" = "value",
    productImagesContext: string = ""
): string {
    let userPrompt = `=== BRIEFING ===
Topic: ${topic}
Target Audience: ${targetAudience}
Pain Point: ${painPoint}
${desiredOutcome ? `Desired Outcome: ${desiredOutcome}` : ""}
${proofPoints ? `Proof Points: ${proofPoints}` : ""}
${ctaAction ? `CTA Action: ${ctaAction}` : ""}

=== POST TYPE: ${postType.toUpperCase()} ===
${postType === "value" 
  ? `FOCUS: Educational/insight post (80% of content mix)
- Teach something valuable the reader can use immediately
- Position Lifetrek as a thought leader, not a vendor
- CTA: Low-friction (PDF, checklist, comment "GUIA", DM for more)
- Tone: Engineer-to-engineer, consultative, educational
- Goal: Build trust and brand association, not immediate sales`
  : `FOCUS: Commercial/offer post (20% of content mix)
- Highlight specific capability, capacity, or pilot program
- CTA: Stronger but still professional (schedule call, request quote, pilot project)
- Tone: Confident, direct, still technical
- Goal: Generate qualified leads and conversations`}

=== AVAILABLE PRODUCT IMAGES ===
${productImagesContext || "No product images available. Generate all visuals."}

=== BRAND ASSOCIATIONS (Reinforce at least ONE) ===
- "Local Swiss-level" → Produção BR com padrão tecnológico global (Citizen M32, ZEISS)
- "Regulatory-safe" → ISO 13485, ANVISA, documentação para auditorias
- "Cash-friendly supply chain" → Menos estoque, menos lead time (30d vs 90d)
- "Engineering partner" → Co-engineering, DFM, suporte técnico próximo
`;

    if (isBatch) {
        userPrompt += `\n=== BATCH MODE ===
Generate ${numberOfCarousels} DISTINCT carousels for a content calendar.
Each should have a DIFFERENT angle/approach on the topic.
Vary the hook types (Label, Question, Conditional, etc).`;
    } else {
        userPrompt += `\n=== SINGLE CAROUSEL MODE ===
Generate ONE high-impact carousel following the HOOK → VALUE → CTA structure.`;
    }

    return userPrompt;
}

const slideSchema = {
    type: "object",
    properties: {
        type: { type: "string", enum: ["hook", "content", "cta"] },
        headline: { type: "string", description: "Bold headline, under 10 words" },
        body: { type: "string", description: "Supporting text, under 25 words" },
        backgroundType: { type: "string", enum: ["asset", "generate", "product_image"] },
        assetId: { type: "string", description: "Asset ID if using existing asset" },
        productImageId: { type: "string", description: "Product image ID if using product photo" },
        imageGenerationPrompt: { type: "string" },
        // STRATEGIST → COPYWRITER & DESIGNER NOTES
        copywriter_notes: { 
            type: "string", 
            description: "Instructions for copywriter: tone adjustments, word choices, emphasis" 
        },
        designer_notes: { 
            type: "string", 
            description: "Instructions for designer: visual direction, mood, composition, colors" 
        },
        brand_association: { 
            type: "string", 
            enum: ["local_swiss_level", "regulatory_safe", "cash_friendly", "engineering_partner"],
            description: "Which brand association this slide reinforces"
        },
        image_style: { 
            type: "string", 
            enum: ["client_perspective", "technical_proof", "abstract_premium", "product_showcase"],
            description: "Visual style direction for image generation"
        },
        textPlacement: { type: "string", enum: ["burned_in"], description: "Always burned_in for Nano Banana" }
    },
    required: ["type", "headline", "body", "backgroundType", "copywriter_notes", "designer_notes"]
};

export function getTools(isBatch: boolean): any[] {
    return [
        {
            type: "function",
            function: {
                name: isBatch ? "create_batch_carousels" : "create_carousel",
                description: isBatch ? "Create multiple carousels with full strategist notes" : "Create a single carousel with full strategist notes",
                parameters: {
                    type: "object",
                    properties: isBatch ? {
                        carousels: {
                            type: "array",
                            items: {
                                type: "object",
                                properties: {
                                    topic: { type: "string" },
                                    targetAudience: { type: "string" },
                                    strategic_angle: { type: "string", description: "The unique angle/approach for this carousel" },
                                    brand_associations_used: { 
                                        type: "array", 
                                        items: { type: "string" },
                                        description: "Which brand associations are reinforced in this carousel"
                                    },
                                    slides: { type: "array", items: slideSchema },
                                    caption: { type: "string" },
                                    caption_hashtags: { type: "array", items: { type: "string" } }
                                },
                                required: ["topic", "targetAudience", "strategic_angle", "slides", "caption"]
                            }
                        }
                    } : {
                        topic: { type: "string" },
                        targetAudience: { type: "string" },
                        strategic_angle: { type: "string", description: "The unique angle/approach for this carousel" },
                        brand_associations_used: { 
                            type: "array", 
                            items: { type: "string" },
                            description: "Which brand associations are reinforced in this carousel"
                        },
                        slides: { type: "array", items: slideSchema },
                        caption: { type: "string" },
                        caption_hashtags: { type: "array", items: { type: "string" } }
                    },
                    required: isBatch ? ["carousels"] : ["topic", "targetAudience", "strategic_angle", "slides", "caption"]
                }
            }
        }
    ];
}

export function constructSystemPrompt(assetsContext: string, postType: "value" | "commercial" = "value"): string {
    return `You are the Lead LinkedIn Content Strategist for Lifetrek Medical.
Your job is to create content that builds brand associations while delivering genuine value.

=== YOUR MISSION (Alex Hormozi Framework) ===
Design LinkedIn content that:
1. Builds STRONG brand associations (see below)
2. Delivers REAL, standalone value in every post
3. Generates pipeline via LOW-FRICTION CTAs embedded naturally

=== MANDATORY STRUCTURE: HOOK → VALUE → LIGHT CTA ===
Every carousel MUST follow this:
- **HOOK (Slide 1)**: Callout + implied payoff. Make the avatar think "That's me!"
- **VALUE (Slides 2-5)**: Solve ONE narrow problem with SPECIFICS. Not fluff.
- **CTA (Final Slide)**: Next step tied to MORE VALUE (PDF, checklist, DM), not a hard pitch.

=== POST TYPE: ${postType.toUpperCase()} ===
${postType === "value" 
  ? `This is a VALUE POST (80% of content mix):
- Focus: Educational, insight, behind-the-scenes
- Goal: Position Lifetrek as thought leader
- CTA: "Comente 'GUIA'", "DM para PDF", "Quer o checklist?"
- Tone: Teacher, consultant, engineer-to-engineer
- The reader should be able to USE this content even without Lifetrek`
  : `This is a COMMERCIAL POST (20% of content mix):
- Focus: Specific offer, capacity, pilot program
- Goal: Generate qualified leads
- CTA: "Agende uma call", "Solicite orçamento", "Projeto piloto"
- Tone: Confident, direct, still technical
- Still follows HOOK → VALUE → CTA, just with stronger CTA`}

=== BRAND ASSOCIATIONS (Reinforce at least ONE per carousel) ===
${BRAND_ASSOCIATIONS}

=== KNOWLEDGE BASE ===
${COMPANY_CONTEXT}

${VALUE_PROPOSITION_FRAMEWORK}

${KILLER_HOOKS_PLAYBOOK}

=== ASSET LIBRARY ===
${assetsContext}

=== YOUR OUTPUT (STRATEGIST MODE) ===
For each slide, you MUST provide:
1. **headline**: Bold, under 10 words
2. **body**: Supporting text, under 25 words
3. **copywriter_notes**: Instructions for the copywriter to refine (tone, emphasis, word choice)
4. **designer_notes**: Instructions for the designer (visual direction, mood, composition)
5. **brand_association**: Which brand pillar this slide reinforces
6. **image_style**: Visual direction ("client_perspective" for showing CLIENT's experience, "technical_proof" for machinery/certifications, "abstract_premium" for conceptual, "product_showcase" for products)
7. **backgroundType**: "generate" for AI images, "asset" for existing, "product_image" for product photos

=== CRITICAL RULES ===
1. HOOK must use a formula from KILLER HOOKS PLAYBOOK (Label, Question, Conditional, etc)
2. PROOF must be SPECIFIC: machine names (Citizen M32), certifications (ISO 13485), numbers (30 dias)
3. CTA must be LOW-FRICTION for value posts, can be stronger for commercial posts
4. Each slide should reinforce ONE brand association
5. Content in Brazilian Portuguese (pt-BR)
6. Tone: Technical but accessible, confident but not salesy

=== LINKEDIN BEST PRACTICES ===
${LINKEDIN_BEST_PRACTICES}
`;
}
